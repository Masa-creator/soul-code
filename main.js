function sumDigits(n){return n.toString().split("").reduce((a,b)=>a+Number(b),0)}function reduceKeepMasters(n){while(n>9&&!(n===11||n===22||n===33)){n=sumDigits(n)}return n}function lifePath(dateStr){const n=dateStr.replace(/-/g,"").split("").reduce((a,b)=>a+Number(b),0);return reduceKeepMasters(n)}function karmicDebt(dateStr){const debts=[13,14,16,19];const day=Number(dateStr.split("-")[2]||0);const month=Number(dateStr.split("-")[1]||0);const year=Number(dateStr.split("-")[0]||0);const candidates=[day,month,reduceKeepMasters(sumDigits(year)),reduceKeepMasters(sumDigits(day+month+year))];const hit=candidates.find(v=>debts.includes(v));return hit||null}
const vowels=new Set("AEIOUYaeiouy");function lettersToNumber(name){const map={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8};let sum=0;for(const ch of name.toUpperCase())if(map[ch])sum+=map[ch];return reduceKeepMasters(sum)}function heartNumber(name){const map={A:1,E:5,I:9,O:6,U:3,Y:7};let s=0;for(const ch of name.toUpperCase())if(map[ch]!==undefined)s+=map[ch];return reduceKeepMasters(s||0)}function personalityNumber(name){const all=lettersToNumber(name);const heart=heartNumber(name);return all===heart?reduceKeepMasters(all+4):reduceKeepMasters(Math.abs(all-heart)||2)}
const meanings={1:`ç§ãŒè¦‹ã‚‹ã®ã¯ã€ã‚ãªãŸã®èŠ¯ã«ç¯ã‚‹ã€Œé–‹æ‹“ã€ã®ç‚ã€‚å°ã•ãªæ±ºæ–­ã‚’å…ˆã«ç½®ãã»ã©ã€ä¸–ç•Œã¯ã‚ãªãŸã®å‘³æ–¹ã«ãªã‚‹ã€‚è¿·ã£ãŸã‚‰â€œå…ˆã«å‹•ãâ€ãŒåˆå›³ã€‚`,2:`ã‚ãªãŸã®éµã¯ã€Œå…±é³´ã€ã€‚äººã®æ°—é…ã‚’æ•æ„Ÿã«æ‰ãˆã‚‹åŠ›ãŒã‚ã‚‹ã‹ã‚‰ã€æ©‹æ¸¡ã—å½¹ã§é‹ãŒé–‹ãã€‚æ€¥ãŒãšã€æ¯ã‚’åˆã‚ã›ã‚‹ã»ã©è¿½ã„é¢¨ã«ã€‚`,3:`ã€Œè¡¨ç¾ã€ãŒã‚ãªãŸã®æµ„åŒ–ã€‚è¨€è‘‰ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»éŸ³â€¦å¤–ã¸å‡ºã™ã»ã©é‹ãŒæ¾„ã‚€ã€‚éŠã³å¿ƒã‚’äºˆå®šã«å…¥ã‚Œã‚‹ã¨ã€ä¸æ€è­°ã¨è‰¯ç¸ãŒå·¡ã‚‹ã€‚`,4:`å …å®Ÿã®æ˜Ÿã€‚ä»•çµ„ã¿åŒ–ã¨ç¿’æ…£ã¥ãã‚ŠãŒå¹¸é‹ã®å‘¼ã³æ°´ã€‚ä»Šæ—¥ã¯â€œ5åˆ†ã ã‘â€ã®ç©ã¿é‡ã­ã‚’ã€‚å®‰å®šãŒã€æ¬¡ã®é£›èºå°ã«ãªã‚Šã¾ã™ã€‚`,5:`å¤‰åŒ–ã®æ˜Ÿã€‚æ—…ãƒ»å­¦ã³ãƒ»ç’°å¢ƒæ›¿ãˆãŒã‚¹ã‚¤ãƒƒãƒã€‚å›ºå®šè¦³å¿µã‚’ä¸€ã¤æ‰‹æ”¾ã™ã¨ã€é¢¨ãŒé€šã£ã¦ä¸€æ°—ã«å±•é–‹ã€‚èº«è»½ã•ãŒå‘³æ–¹ã§ã™ã€‚`,6:`æ„›ã¨æ•´ãˆã®æ˜Ÿã€‚èº«è¿‘ãªäººã¸æ³¨ãæ€ã„ã‚„ã‚ŠãŒã€å·¡ã‚Šå·¡ã£ã¦å¤§ããªã”ç¸ã«ã€‚ä½ã¾ã„ã®å°ã•ãªå¿«é©åŒ–ãŒé‡‘é‹ã‚‚å‹•ã‹ã™ã€‚`,7:`æ¢æ±‚ã®æ˜Ÿã€‚é™ã‹ã«æ·±ãæ˜ã‚‹æ™‚æœŸã»ã©ã€ç›´æ„ŸãŒç ”ãæ¾„ã¾ã•ã‚Œã‚‹ã€‚ãƒ‡ã‚¸ã‚¿ãƒ«ã‚’å°‘ã—é›¢ã‚Œã€è‡ªç„¶ã®ãƒªã‚ºãƒ ã«åˆã‚ã›ã¦ã€‚`,8:`çµæœã®æ˜Ÿã€‚å€¤ä»˜ã‘ãƒ»äº¤æ¸‰ãƒ»è©•ä¾¡ã®è¦‹ç›´ã—ã§åç©«æœŸã€‚é æ…®ã—ã¦ã„ãŸåŠ›ã‚’å…¬ã«ã™ã‚‹ã¨ã€æ­£å½“ãªå¯¾ä¾¡ãŒæµã‚Œè¾¼ã¿ã¾ã™ã€‚`,9:`æµ„åŒ–ã¨å®Œæˆã€‚æ‰‹æ”¾ã—ãŒæ¬¡ã®æ‰‰ã€‚æ„Ÿè¬ã‚’è¨€è‘‰ã«å‡ºã™ã»ã©ã€çµ‚ã‚ã‚ŠãŒå§‹ã¾ã‚Šã¸ã¨å¤‰ã‚ã‚‹ã€‚å„ªã—ãç· ã‚ã¦ã€è»½ãé€²ã‚€ã€‚`,11:`éœŠæ„Ÿã®å›ç·šãŒå¼·ã„ãƒã‚¹ã‚¿ãƒ¼ã€‚ã²ã‚‰ã‚ããŒé™ã‚Šã‚„ã™ã„ã®ã§ã€æœã®ãƒ¡ãƒ¢ã‚’ç¿’æ…£ã«ã€‚å…‰ã‚’åˆ†ã‹ã¡åˆã†ã»ã©é“ãŒæ‹“ã‘ã‚‹ã€‚`,22:`ç¾å®ŸåŒ–ã®ãƒã‚¹ã‚¿ãƒ¼ã€‚å¤§ããªæ§‹æƒ³ã‚’åœ°ã«é™ã‚ã™åŠ›ã€‚ä»•çµ„ã¿ãƒ»ãƒãƒ¼ãƒ ãƒ»ã‚¹ã‚±ãƒ¼ãƒ«æ„Ÿã«æŒ‘ã‚€ã¨ã€é‹å‘½ãŒèƒŒä¸­ã‚’æŠ¼ã™ã€‚`,33:`ç„¡æ¡ä»¶ã®æ…ˆæ„›ã€‚å ´ã®ç©ºæ°—ã‚’æ¸©ã‚ã‚‹ã ã‘ã§äººãŒæ•´ã†ã€‚è‡ªåˆ†ã®ã‚±ã‚¢ã‚’å…ˆã«ç½®ãã»ã©ã€å¤©ã‹ã‚‰ã®åŠ©ã‘ãŒå±Šãã‚„ã™ã„ã€‚`};
function buildFreeMessage({name,lp,heart,perso,debt}){const base=meanings[lp]||"ä»Šã¯é™ã‹ã«æ•´ãˆã‚‹æµã‚Œã€‚";const spice=heart===lp?"å¿ƒã®é¡˜ã„ã¨ç¾å®ŸãŒé‡ãªã‚Šã‚„ã™ã„æ™‚æœŸã§ã™ã€‚":`å†…ãªã‚‹é¡˜ã„ã¯ã€Œ${heart}ã€ã€å¤–ã¸ã®å°è±¡ã¯ã€Œ${perso}ã€ã€‚ã“ã®å·®ã‚’æ„è­˜ã™ã‚‹ã¨ä¸€æ®µã¨ç”Ÿãã‚„ã™ããªã‚Šã¾ã™ã€‚`;const karma=debt?`ã¾ãŸã€ã‚«ãƒ«ãƒæ•°ã€Œ${debt}ã€ãŒç¤ºã™å­¦ã³ãŒä»Šä¸–ã®ã‚®ãƒ•ãƒˆã€‚ç„¦ã‚‰ãšä¸å¯§ã«å‘ãåˆãˆã°å¿…ãšæ˜‡è¯ã—ã¾ã™ã€‚`:"";const hook="â€” æœ‰æ–™ç‰ˆã§ã¯é‡‘é‹ãƒ»æ‹æ„›ãƒ»ä»•äº‹ãƒ»ä»Šå¾Œ3ã‹æœˆã®é–‹é‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã€ã‚ãªãŸå°‚ç”¨ã®è¨€è‘‰ã§æ·±æ˜ã‚Šã—ã¾ã™ã€‚";return `ã€${name}ã•ã‚“ã®é­‚ã‚³ãƒ¼ãƒ‰ï¼š${lp}ã€‘\n`+base+spice+karma+hook}
function makeTweetUrl(t,u=""){return`https://twitter.com/intent/tweet?text=${encodeURIComponent(t)}&url=${encodeURIComponent(u)}`}
const REFERRAL_WHITELIST=["SOULCODE.creator","SOULCODE.VIP","MASA2025"];function hasReferralUnlock(code){if(!code)return false;return REFERRAL_WHITELIST.includes(code.trim())}
window.addEventListener("DOMContentLoaded",()=>{const nameEl=document.getElementById("name");const birthEl=document.getElementById("birth");const refEl=document.getElementById("ref");const btn=document.getElementById("startBtn");const result=document.getElementById("result");const xBtn=document.getElementById("shareX");const goPlans=document.getElementById("goPlans");const params=new URLSearchParams(location.search);const rc=params.get("referral");if(rc){refEl.value=rc}btn.addEventListener("click",()=>{const name=(nameEl.value||"ã‚ãªãŸ").trim();const birth=birthEl.value;if(!birth){alert("ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");return}const lp=lifePath(birth);const heart=heartNumber(name);const perso=personalityNumber(name);const debt=karmicDebt(birth);const text=buildFreeMessage({name,lp,heart,perso,debt});result.textContent=text;const tweet=`#SOULCODE ç„¡æ–™è¨ºæ–­\n${name}ã•ã‚“ã®ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ã¯ ${lp}ã€‚`;xBtn.href=makeTweetUrl(tweet,location.origin);const code=refEl.value.trim();if(hasReferralUnlock(code)){localStorage.setItem("SOULCODE_UNLOCK","1");goPlans.textContent="ğŸ”“ æœ‰æ–™ãƒšãƒ¼ã‚¸ã‚’é–‹ãï¼ˆç´¹ä»‹ã‚³ãƒ¼ãƒ‰èªè¨¼ï¼‰";goPlans.href="./paid.html?plan=premium&unlock=1"}else{localStorage.removeItem("SOULCODE_UNLOCK");goPlans.textContent="æœ‰æ–™ãƒ—ãƒ©ãƒ³ã‚’è¦‹ã‚‹";goPlans.href="./plans.html"}})});
